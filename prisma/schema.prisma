// prisma/schema.prisma

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String  @id @default(uuid())
  image     String?
  firstName String
  lastName  String
  mobile    String
  email     String  @unique
  role      Role    @default(SALES_MANAGER)
  password  String
  location  String
  leads     Lead[]  @relation("SalesManagerLeads")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  Lead      Lead[]
  Course    Course[]
}

model Lead {
  id           String     @id @default(uuid())
  userId       String
  image        String
  name         String
  email        String
  dob          String
  doj          DateTime
  doe          DateTime
  phone        String
  company      String
  status       LeadStatus @default(NEW)
  courseId     String
  course       Course     @relation(fields: [courseId], references: [id])
  address      String
  street       String
  state        String
  city         String
  pinCode      Int
  country      String
  idProof      String
  assignedTo   User?      @relation("SalesManagerLeads", fields: [assignedToId], references: [id])
  assignedToId String?
  createdUser  User       @relation(fields: [userId], references: [id])
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
}

model Course {
  id            String @id @default(uuid())
  userId        String
  image         String
  imagePublicId String
  title         String

  User User   @relation(fields: [userId], references: [id])
  Lead Lead[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Role {
  SUPER_ADMIN
  ADMIN
  SALES_MANAGER
}

enum LeadStatus {
  NEW
  CONTACTED
  FOLLOW_UP
  ENROLLED
  LOST
}
