// prisma/schema.prisma

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String  @id @default(uuid())
  image     String?
  firstName String
  lastName  String
  mobile    String
  email     String  @unique
  role      Role    @default(SALES_MANAGER)
  password  String
  location  String
  leads     Lead[]  @relation("SalesManagerLeads")

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  Lead      Lead[]
  Course    Course[]
  Company   Company[]
}

model Lead {
  id              String     @id @default(uuid())
  userId          String
  image           String?
  imagePublicId   String?
  name            String
  email           String
  dob             DateTime?
  doj             DateTime?
  doe             DateTime?
  phone           String
  company         String
  status          LeadStatus @default(NEW)
  courseId        String
  street          String?
  state           String?
  city            String?
  pinCode         Int?
  country         String?
  idProof         String?
  idProofPublicId String?
  assignedToId    String?
  createdAt       DateTime   @default(now())
  updatedAt       DateTime   @updatedAt

  createdUser User   @relation(fields: [userId], references: [id])
  assignedTo  User?  @relation("SalesManagerLeads", fields: [assignedToId], references: [id])
  course      Course @relation(fields: [courseId], references: [id])
}

model Course {
  id            String @id @default(uuid())
  userId        String
  image         String
  imagePublicId String
  title         String

  User User   @relation(fields: [userId], references: [id])
  Lead Lead[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Company {
  id          String @id @default(uuid())
  companyName String
  logo        String
  userId      String
  owner       User   @relation(fields: [userId], references: [id])
}

enum Role {
  SUPER_ADMIN
  ADMIN
  SALES_MANAGER
  BED
  ACCOUNT
  TECH
  QC
  PLACEMENT
}

enum LeadStatus {
  NEW
  CONVERTED
  CONTACTED
  FOLLOW_UP
  ENROLLED
  LOST
}
